<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shared List - Lokeet</title>

  <!-- Favicon -->
  <link rel="icon" href="/icon.png" type="image/png">
  <link rel="apple-touch-icon" href="/apple-icon.png">

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#e7ac6d">

  <!-- iOS Support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Lokeet">

  <link rel="stylesheet" href="/style.css">
  <!-- MapLibre GL CSS -->
  <link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet" />
</head>
<body>
  <!-- Loading State -->
  <div id="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Loading shared list...</p>
  </div>

  <!-- Error State -->
  <div id="error" class="error-state" style="display: none;">
    <div class="error-icon">‚ö†Ô∏è</div>
    <h2>List Not Found</h2>
    <p>This shared list doesn't exist or has been removed.</p>
    <a href="/" class="cta-button">Go to Lokeet</a>
  </div>

  <!-- Content (Hidden Until Loaded) -->
  <div id="content" style="display: none;">
      <!-- Top Navigation -->
      <div class="share-top-nav">
        <div class="share-nav-left">
          <div class="share-logo">Lokeet</div>
        </div>
        <div class="share-nav-right">
          <div class="share-menu-container">
            <button id="share-menu-btn" class="share-menu-btn">
              <svg viewBox="0 0 24 24">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
            </button>
            <div id="share-menu-dropdown" class="share-menu-dropdown">
              <div class="share-menu-item">
                <a href="/login.html" class="share-menu-link">Create Your Own List</a>
              </div>
              <div class="share-menu-item">
                <a href="/" class="share-menu-link">Learn More</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="tabs-fixed">
        <div class="tabs">
          <button class="tab active" data-tab="saves">Saves</button>
          <button class="tab" data-tab="map">Map</button>
          <button class="tab" data-tab="calendar">Calendar</button>
        </div>
      </div>

      <!-- Category Info -->
      <div class="category-header">
        <h1 id="category-name">Loading...</h1>
        <div class="category-meta">
          <span id="item-count">0 places</span>
          <span class="separator">‚Ä¢</span>
          <span id="view-count">1 category</span>
        </div>
      </div>

      <!-- Category Filter (for multiple categories) -->
      <div id="share-category-filter-bar" class="category-filter-bar" style="display: none;">
        <div class="filter-group" style="position: relative;">
          <button id="share-category-toggle" type="button" style="padding: 6px 8px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 14px; background: transparent; cursor: pointer; color: #333; font-weight: 500; display: flex; align-items: center; gap: 8px;">
            <span id="share-category-label">Select Categories</span>
            <span style="font-size: 12px;">‚ñº</span>
          </button>
          <div id="share-category-dropdown" style="display: none; position: absolute; top: 100%; left: 0; margin-top: 4px; background: white; border: 1px solid #e0e0e0; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 100; min-width: 250px; max-height: 300px; overflow-y: auto;">
            <div style="padding: 12px;">
              <div id="share-category-checkboxes"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content Container -->
      <div class="share-content-container">
        <!-- Saves Tab -->
        <div id="saves-tab" class="tab-content active">
          <!-- Saves Container with white background -->
          <div class="saves-container">
            <!-- Location Cards -->
            <div id="location-list" class="location-list">
              <!-- Cards will be inserted here by JavaScript -->
            </div>
          </div>
        </div>

        <!-- Map Tab -->
        <div id="map-tab" class="tab-content">
          <div id="map-container" class="map-container">
            <div id="radar-map"></div>
          </div>
        </div>

        <!-- Calendar Tab -->
        <div id="calendar-tab" class="tab-content">
          <div id="calendar-view" style="background: white; padding: 40px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;">
            <div style="font-size: 48px; margin-bottom: 16px;">üìÖ</div>
            <h2 style="font-size: 24px; font-weight: 700; margin-bottom: 12px; color: #000;">Calendar View</h2>
            <p style="color: #666; font-size: 16px;">Event dates will appear here</p>
          </div>
        </div>
      </div>

    <!-- Footer -->
    <div class="share-footer">
      <p>Made with ‚ù§Ô∏è for Locals</p>
    </div>
  </div>

  <!-- Preview Modal -->
  <div id="preview-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="preview-modal-title">Save Details</h2>
        <button class="close-btn" onclick="closePreviewModal()">&times;</button>
      </div>
      <div id="preview-modal-body"></div>
    </div>
  </div>

  <!-- Load MapLibre GL JS -->
  <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
  <!-- Load our app script -->
  <script src="/share.js"></script>

  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then((registration) => {
            console.log('ServiceWorker registered:', registration.scope);
          })
          .catch((error) => {
            console.log('ServiceWorker registration failed:', error);
          });
      });
    }
  </script>
</body>
</html>
